%!TEX root = main.tex

\section{Details in Section~\ref{sec:algo}}

\paragraph{Proof of Proposition~\ref{prop-conj-fa-prod}.}
Let $\Aut_1 = ((\controls_1, \transrel_1), S_1)$ and $\Aut_2 = ((\controls_2, \transrel_2), S_2)$ be two conjunctive \FA{}s such that $S_1 = \{(p_1, p'_1),\ldots, (p_m, p'_m)\}$ and $S_2 = \{(q_1, q'_1), \ldots, (q_n, q'_n)\}$ with $m \le n$. Then we construct a conjunctive \FA{} $\Aut = (\controls_1 \times \controls_2, \transrel_1 \times \transrel_2, S)$, where 
$$S= \{((p_i, q_i), (p'_i, q'_i)) \mid i \in [m]\} \cup \{((p_m, q_{m+i}), (p'_m, q_{m+i})) \mid i \in [n-m]\}.$$ 
Note $|S|  = \max(|S_1|, |S_2|)$. Evidently $\Lang(\Aut) = \Lang(\Aut_1) \cap \Lang(\Aut_2)$. 



\paragraph{Detailed complexity analysis.}
For each $i$, 
%\begin{itemize}
%\item 
let $M_i$ be the maximum number of elements in $\cE_i(x)$ for $x  \in \vars(S)$,
%\item 
and $N_i$ be the maximum size of the conjunctive \FA{}s in $\bigcup \limits_{x \in \vars(S)} \cE_i(x)$.
%\end{itemize}
Then we have $M_{i-1} \le (\rcdim(S)+1)M_i $. Moreover, since each string function $f$ satisfies   $|f| \le \rcphi(S)$, we have that $N_{i-1} \le \ell(|f|, N_i) \le \ell(\rcphi(S), N_i)$ (note that we have assumed that $\ell$ is monotonic). Because for each $x \in \vars(S)$, $\cE_{\rcdep(S)}(x)$ contains at most $\rcreg(S)$ elements, and 
each conjunctive \FA{} in $\cE_{\rcdep(S)}(x)$ is of size bounded by $\rcpsi(S)$, we have that for each $x \in \vars(S)$, $\cE(x)$ contains at most $(\rcdim(S)+1)^{\rcdep(S)}\rcreg(S)$ elements, and each conjunctive \FA{} in $\cE(x)$ is of size bounded by $\ell^{\langle \rcdep(S) \rangle}(\rcphi(S), \rcpsi(S))$. 
We emphasise that, according to the \prerec{} assumption, the construction of these \FA{}s can be done in nondeterministic $\ell^{\langle \rcdep(S) \rangle}(\rcphi(S), \rcpsi(S))$ space as well. 
Therefore, according to Proposition~\ref{prop-conj-fa-prod}, for each $x \in \vars(S)$, the conjunctive product \FA{} $\Aut_x=((\controls_x, \transrel_x), S_x)$ of these conjunctive \FA{}s  in $\cE(x)$ is of size 
$$(\ell^{\langle \rcdep(S) \rangle}(\rcphi(S), \rcpsi(S)))^{(\rcdim(S)+1)^{\rcdep(S)} \rcreg(S)},$$
and $|S_x| \le (\ell^{\langle \rcdep(S) \rangle}(\rcphi(S), \rcpsi(S)))^2$. Therefore, the size of the (standard) \FA{} corresponding to $\Aut_x$ is 
$$(\ell^{\langle \rcdep(S) \rangle}(\rcphi(S), \rcpsi(S)))^{(\rcdim(S)+1)^{\rcdep(S)} \rcreg(S) (\ell^{\langle \rcdep(S) \rangle}(\rcphi(S), \rcpsi(S)))^2}.$$

Since the nonemptiness of an \FA{} can be solved in nondeterministic logarithmic space, we conclude that the nonemptiness of $\Aut_x$ can be solved in 
{\small
$$(\rcdim(S)+1)^{\rcdep(S)} \rcreg(S) (\ell^{\langle \rcdep(S) \rangle}(\rcphi(S), \rcpsi(S)))^2 \log \ell^{\langle \rcdep(S) \rangle}(\rcphi(S), \rcpsi(S))$$
}
space.

In summary, the aforementioned nondeterministic algorithm takes 
$$|\vars(S)|(\rcdim(S)+1)^{\rcdep(S)}  \rcreg(S) \left(\ell^{\langle \rcdep(S) \rangle}(\rcphi(S), \rcpsi(S)) \right)^c$$
 space for some constant $c > 0$.